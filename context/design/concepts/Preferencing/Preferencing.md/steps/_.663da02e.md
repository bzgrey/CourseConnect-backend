---
timestamp: 'Mon Nov 17 2025 23:09:32 GMT-0500 (Eastern Standard Time)'
parent: '[[..\20251117_230932.e80892ad.md]]'
content_id: 663da02e43f44f0a2027b4cf52c6cf7468327014abc4398536f5b79853bb40de
---

# Preferencing \[User, Item]

* **concept**: Preferencing \[User, Item]

* **purpose**: To allow users to assign a personal numerical score to a set of items, and to query these scores.

* **principle**: Each user can assign at most one score to any given item and change it at any time. They can also remove the item and its associated score.

* **state**:
  * A set of `Users` with
    * an `item` of type `Item`
    * a `score` of type `Number`

* **actions**:
  * `setScore (user: User, item: Item, score: Number): (preference: Preference)`
    * **requires**: `score` must be a valid number.
    * **effects**: Creates and returns a new `Preference` record linking the `user` and `item` with the given `score`. If a preference from that user for that item already exists, it is updated with the new score.
  * `removeItem (item: Item)`
    * **requires**: The item must be a valid identifier.
    * **effects**: Removes **all** `Preference` records associated with the given `item`, regardless of the user who created them. This is typically used for cleanup when an item is deleted from another system.

* **queries**:
  * `_getPreferencesByItem (item: Item): (preference: Preference)`
    * **purpose**: To find all individual preference records associated with a specific item. This is crucial for cleanup operations (used by `removeItem`) or for fetching all data for aggregation.
    * **inputs**: `item` - The identifier of the item to look up.
    * **outputs**: `preference` - Zero or more `Preference` records associated with the given `item`.
  * `_getPreferencesByUser (user: User): (item: Item, score: Number)`
    * **purpose**: To retrieve all the scores a specific user has submitted.
    * **inputs**: `user` - The identifier of the user.
    * **outputs**: `item`, `score` - Zero or more pairs of items and the scores the user assigned to them.
  * `_getScoreForUserAndItem (user: User, item: Item): (score: Number)`
    * **purpose**: To retrieve the specific score a single user gave to a single item.
    * **inputs**: `user` - The user identifier. `item` - The item identifier.
    * **outputs**: `score` - The numerical score, if one exists. Returns at most one result.
